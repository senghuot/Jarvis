<!DOCTYPE html>
<html lang="en-US" data-ng-app="demo">
  <head>
    <meta charset="UTF-8">
    <title>Jarvis</title>
    <link rel="stylesheet" href="bower_components/bootstrap/dist/css/bootstrap.css">
    <link rel="stylesheet" href="css/animate.css">
    <link rel="stylesheet" href="css/custom.css">

    <script src="bower_components/jquery/dist/jquery.min.js"></script>
    <script src="bower_components/bootstrap/dist/js/bootstrap.js"></script>
    <script type="text/javascript" src="js/scripts.js"></script>
  </head>
    
  <body data-ng-controller="SimpleController">
    
    <section id="intro">
      <button id="init" type="button" class="btn btn-lg btn-default" ng-click="initBtnClicked()">Start</button>
      <br/>
      <button id="next" type="button" class="btn btn-lg btn-success" ng-click="nextBtnClicked()">next</button>

      <div id="loading" class="bounceIn animated" data-wow-delay="1s">
        <img src="images/gears.gif" width="100px">
      </div>
    </section>

    <section id="compute" class="container bounceIn animated">
      <form class="form-horizontal">
         <div class="form-group">
              <label for="inputEmail" class="control-label col-xs-2">Amount</label>
              <div class="col-xs-5">
                  <input type="text" class="form-control">
              </div>
          </div>
          <div class="form-group">
              <label for="inputEmail" class="control-label col-xs-2">Account Type</label>
              <div class="col-xs-5 dropdown">
                <button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                  Dropdown
                  <span class="caret"></span>
                </button>
                <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
                  <li><a href="#">Action</a></li>
                  <li><a href="#">Another action</a></li>
                  <li><a href="#">Something else here</a></li>
                  <li><a href="#">Separated link</a></li>
                </ul>
              </div>
          </div>
          <div class="form-group">
              <label for="inputPassword" class="control-label col-xs-2">Booking Type</label>
              <div class="col-xs-5">
                  <input type="text" class="form-control">
              </div>
          </div>
          <div class="form-group">
              <div class="col-xs-offset-2 col-xs-10">
                  <button id="compute-btn" ng-click="computeBtnClicked()" class="btn btn-primary">Compute</button>
              </div>
          </div>
      </form>
    </section>

    <script src="bower_components/angular/angular.js"></script>
    <script>
      var demo = angular.module('demo', []);

      demo.controller('SimpleController', function ($scope, $http) {
        $scope.initBtnClicked = function(){
          // display loading screen
          $('#init').toggle();
          $('#loading').toggle();

          // grab the music
          var audio = new Audio('intro.mp3');
          audio.play();

          // this is too request server to train the data
          $http.get('http://127.0.0.1:5000/init')
            .success(function(response){
              $('#loading').removeClass().addClass('bounceOut animated');
              $('#next').toggle().addClass('bounceIn animated');
              audio.pause();
            }).error(function(error){
              console.log(error);
          });
        };

        $scope.nextBtnClicked = function() {
          $('#next').toggle();
          $('#compute').toggle();
        };

        // compute the result without encodig the result first
        $scope.computeBtnClicked = function() {

          data = {
                  customers:[
                    {
                      amount           : 147060,
                      accountType      : 1,
                      bookingType      : 2,
                      expectedRevenue  : 58824,
                      numProducts      : 13,
                      oppRecordType    : 4,
                      forecastCategory : 3,
                      leadSource       : 10,
                      annualRevenue    : 350000,
                      employees        : 20,
                      hasCoreProducts  : 0,
                      numLocations     : -1,
                      numProducers     : -1,
                      openOpp          : 147160,
                      openOppCount     : 2
                    }
                  ] 
                };

          $http.post('http://127.0.0.1:5000/compute', data)
            .success(function(response) {
              console.log(response);
            }).error(function(error) {
              console.log(error);
            });
        };

      });

    </script>
  </body>

</html>